
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>route_distances.ted package &#8212; route-distances 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="route_distances.tools package" href="route_distances.tools.html" />
    <link rel="prev" title="route_distances.lstm package" href="route_distances.lstm.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">route-distances</a></h1>



<p class="blurb">Routines for calculating route-distances</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="python.html">Python interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="route_distances.html">route_distances package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="route_distances.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="route_distances.lstm.html">route_distances.lstm package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">route_distances.ted package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-route_distances.ted.distances">route_distances.ted.distances module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-route_distances.ted.reactiontree">route_distances.ted.reactiontree module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-route_distances.ted.utils">route_distances.ted.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-route_distances.ted">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="route_distances.tools.html">route_distances.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="route_distances.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_distances.html#module-route_distances.clustering">route_distances.clustering module</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_distances.html#module-route_distances.route_distances">route_distances.route_distances module</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_distances.html#module-route_distances.validation">route_distances.validation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_distances.html#module-route_distances">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="route_distances.html">route_distances package</a><ul>
      <li>Previous: <a href="route_distances.lstm.html" title="previous chapter">route_distances.lstm package</a></li>
      <li>Next: <a href="route_distances.tools.html" title="next chapter">route_distances.tools package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="route-distances-ted-package">
<h1>route_distances.ted package<a class="headerlink" href="#route-distances-ted-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-route_distances.ted.distances">
<span id="route-distances-ted-distances-module"></span><h2>route_distances.ted.distances module<a class="headerlink" href="#module-route_distances.ted.distances" title="Permalink to this headline">¶</a></h2>
<p>Module contain method to compute distance matrix using TED</p>
<dl class="py function">
<dt id="route_distances.ted.distances.distance_matrix">
<code class="sig-prename descclassname"><span class="pre">route_distances.ted.distances.</span></code><code class="sig-name descname"><span class="pre">distance_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">routes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.distances.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance matrix between each pair of routes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>routes</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – the routes to calculate pairwise distance on</p></li>
<li><p><strong>content</strong> (<em>str</em>) – determine what part of the tree to include in the calculation</p></li>
<li><p><strong>timeout</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – if given, raises an exception if timeout is taking longer time</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the square distance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-route_distances.ted.reactiontree">
<span id="route-distances-ted-reactiontree-module"></span><h2>route_distances.ted.reactiontree module<a class="headerlink" href="#module-route_distances.ted.reactiontree" title="Permalink to this headline">¶</a></h2>
<p>Module containing helper classes to compute the distance between to reaction trees using the APTED method
Since APTED is based on ordered trees and the reaction trees are unordered, plenty of
heuristics are implemented to deal with this.</p>
<dl class="py class">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">route_distances.ted.reactiontree.</span></code><code class="sig-name descname"><span class="pre">ReactionTreeWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">reaction_tree</span></em>, <em class="sig-param"><span class="pre">content=&lt;TreeContent.MOLECULES:</span> <span class="pre">'molecules'&gt;</span></em>, <em class="sig-param"><span class="pre">exhaustive_limit=20</span></em>, <em class="sig-param"><span class="pre">fp_factory=None</span></em>, <em class="sig-param"><span class="pre">dist_func=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for a reaction tree that can calculate distances between
trees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_tree</strong> – the reaction tree to wrap</p></li>
<li><p><strong>content</strong> – the content of the route to consider in the distance calculation</p></li>
<li><p><strong>exhaustive_limit</strong> – if the number of possible ordered trees are below this limit create them all</p></li>
<li><p><strong>fp_factory</strong> – the factory of the fingerprint, Morgan fingerprint for molecules and reactions by default</p></li>
<li><p><strong>dist_func</strong> – the distance function to use when renaming nodes</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.info">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">info</span></code><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary with internal information about the wrapper</p>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.first_tree">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">first_tree</span></code><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.first_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first created ordered tree</p>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.trees">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">trees</span></code><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.trees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all created ordered trees</p>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.distance_iter">
<code class="sig-name descname"><span class="pre">distance_iter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exhaustive_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.distance_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all distances computed between this and another tree</p>
<p>There are three possible enumeration of distances possible dependent
on the number of possible ordered trees for the two routes that are compared</p>
<ul class="simple">
<li><p>If the product of the number of possible ordered trees for both routes are
below <cite>exhaustive_limit</cite> compute the distance between all pair of trees</p></li>
<li><p>If both self and other has been fully enumerated (i.e. all ordered trees has been created)
compute the distances between all trees of the route with the most ordered trees and
the first tree of the other route</p></li>
<li><p>Compute <cite>exhaustive_limit</cite> number of distances by shuffling the child order for
each of the routes.</p></li>
</ul>
<p>The rules are applied top-to-bottom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#route_distances.ted.reactiontree.ReactionTreeWrapper" title="route_distances.ted.reactiontree.ReactionTreeWrapper"><em>ReactionTreeWrapper</em></a>) – another tree to calculate distance to</p></li>
<li><p><strong>exhaustive_limit</strong> (<em>int</em>) – used to determine what type of enumeration to do</p></li>
</ul>
</dd>
<dt class="field-even">Yield</dt>
<dd class="field-even"><p>the next computed distance between self and other</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Iterable[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.distance_to">
<code class="sig-name descname"><span class="pre">distance_to</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exhaustive_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.distance_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the minimum distance from this route to another route</p>
<p>Enumerate the distances using <cite>distance_iter</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#route_distances.ted.reactiontree.ReactionTreeWrapper" title="route_distances.ted.reactiontree.ReactionTreeWrapper"><em>ReactionTreeWrapper</em></a>) – another tree to calculate distance to</p></li>
<li><p><strong>exhaustive_limit</strong> (<em>int</em>) – used to determine what type of enumeration to do</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the minimum distance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.reactiontree.ReactionTreeWrapper.distance_to_with_sorting">
<code class="sig-name descname"><span class="pre">distance_to_with_sorting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.reactiontree.ReactionTreeWrapper.distance_to_with_sorting" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance to another tree, by simpling sorting the children
of both trees. This is not guaranteed to return the minimum distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#route_distances.ted.reactiontree.ReactionTreeWrapper" title="route_distances.ted.reactiontree.ReactionTreeWrapper"><em>ReactionTreeWrapper</em></a>) – another tree to calculate distance to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the distance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-route_distances.ted.utils">
<span id="route-distances-ted-utils-module"></span><h2>route_distances.ted.utils module<a class="headerlink" href="#module-route_distances.ted.utils" title="Permalink to this headline">¶</a></h2>
<p>Module containing utilities for TED calculations</p>
<dl class="py class">
<dt id="route_distances.ted.utils.TreeContent">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">route_distances.ted.utils.</span></code><code class="sig-name descname"><span class="pre">TreeContent</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.utils.TreeContent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Possibilities for distance calculations on reaction trees</p>
<dl class="py attribute">
<dt id="route_distances.ted.utils.TreeContent.MOLECULES">
<code class="sig-name descname"><span class="pre">MOLECULES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'molecules'</span></em><a class="headerlink" href="#route_distances.ted.utils.TreeContent.MOLECULES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="route_distances.ted.utils.TreeContent.REACTIONS">
<code class="sig-name descname"><span class="pre">REACTIONS</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'reactions'</span></em><a class="headerlink" href="#route_distances.ted.utils.TreeContent.REACTIONS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="route_distances.ted.utils.TreeContent.BOTH">
<code class="sig-name descname"><span class="pre">BOTH</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'both'</span></em><a class="headerlink" href="#route_distances.ted.utils.TreeContent.BOTH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="route_distances.ted.utils.AptedConfig">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">route_distances.ted.utils.</span></code><code class="sig-name descname"><span class="pre">AptedConfig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">randomize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_children</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.utils.AptedConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">apted.config.Config</span></code></p>
<p>This is a helper class for the tree edit distance
calculation. It defines how the substitution
cost is calculated and how to obtain children nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>randomize</strong> – if True, the children will be shuffled</p></li>
<li><p><strong>sort_children</strong> – if True, the children will be sorted</p></li>
<li><p><strong>dist_func</strong> – the distance function used for renaming nodes, Jaccard by default</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="route_distances.ted.utils.AptedConfig.rename">
<code class="sig-name descname"><span class="pre">rename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.utils.AptedConfig.rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the cost of renaming the label of the source node
to the label of the destination node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node1</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
<li><p><strong>node2</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="route_distances.ted.utils.AptedConfig.children">
<code class="sig-name descname"><span class="pre">children</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.utils.AptedConfig.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns children of node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="route_distances.ted.utils.StandardFingerprintFactory">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">route_distances.ted.utils.</span></code><code class="sig-name descname"><span class="pre">StandardFingerprintFactory</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#route_distances.ted.utils.StandardFingerprintFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Calculate Morgan fingerprint for molecules, and difference fingerprints for reactions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> – the radius of the fingerprint</p></li>
<li><p><strong>nbits</strong> – the fingerprint lengths</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-route_distances.ted">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-route_distances.ted" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021, Molecular AI group.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/route_distances.ted.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>